search:
  solr:
    url: "http://brie.cshl.edu:8983/solr/grm-search"
    schema: "/usr/local/solr/solr/gramene/solr/grm-search/conf/schema.xml"
    port: "8983"
    log_dir: "/var/opt/logs/solr"
    load_fields:
      - "id"
      - "module"
      - "object"
      - "title"
      - "taxonomy"
      - "ontology"
      - "species"
      - "content"

  database:
    host     : cabot
    user     : gramene_web
    password : gram3n3

  page_size: 10

  index_path: search-index

  reusable_schemas: "ensembl,pathway,amigo,ontology"

  tables_to_index:

    "compara": "member[stable_id:description]"

    "ensembl_*": "gene[biotype:description:stable_id]+transcripts[stable_id],seq_region[name],display_xref[display_label];prediction_transcript[display_label]"

    "maps": "feature_type[feature_type];map_set[map_set_name:description]+species[species:common_name];map_type[map_type:description]"

    "ontology": "term[name:term_accession]+term_definition[definition],term_type[term_type],term_synonyms[term_synonym]"

    "pathway_*": "search#pathway[species:gene_name:enzyme_name:reaction_id:reaction_name:ec:pathway_id:pathway_name]"

  list_columns:
    "ensembl_*.dna_align_feature": "hit_name,analysis.logic_name"

    "ensembl_*.gene": "TT:[% SET label=object.display_xref.display_label OR object.stable_id; SET biotype=object.biotype OR 'gene'; SET desc=object.description.remove('\s*\[.*'); \"$label ($biotype): $desc\"; %]" 

    "ensembl_*.prediction_transcript": "display_label"

    "ensembl_*.interpro": "id_field,interpro_ac('Interpro accession &quot;%s&quot; in domain &quot;%s&quot;')"

    "ensembl_*.marker": "type,display_marker_synonym.name"

    "ensembl_*.seq_region": "name"

    "maps.feature": "species.species,feature_type.feature_type,feature_synonyms.feature_name"

    "maps.feature_type": "feature_type,description"

    "maps.map_set": "species.species,map_type.map_type,map_set_name"

    "ontology.term": "term_type.term_type,name,term_accession"

    "pathway_*.search": "gene_name,enzyme_name,reaction_id,reaction_name,ec,pathway_id,pathway_name"

  sql_to_index:
    ensembl_*.gene: |
      select x.dbprimary_acc, x.display_label, x.description, 
             e.db_name, e.db_display_name
      from   xref x, object_xref ox, gene g, external_db e
      where  x.xref_id=ox.xref_id
      and    x.external_db_id=e.external_db_id
      and    ox.ensembl_id=g.gene_id
      and    g.gene_id=?
      and    ox.ensembl_object_type='Gene';

      select x.dbprimary_acc, x.display_label, x.description, 
             e.db_name, e.db_display_name
      from   xref x, object_xref ox, transcript t, gene g, external_db e
      where  x.xref_id=ox.xref_id
      and    x.external_db_id=e.external_db_id
      and    ox.ensembl_id=t.transcript_id
      and    t.gene_id=g.gene_id
      and    g.gene_id=?
      and    ox.ensembl_object_type='Transcript';

      select x.dbprimary_acc, x.display_label, x.description, 
             e.db_name, e.db_display_name
      from   xref x, object_xref ox, translation p, transcript t, 
             gene g, external_db e
      where  x.xref_id=ox.xref_id
      and    x.external_db_id=e.external_db_id
      and    ox.ensembl_id=p.translation_id
      and    p.transcript_id=t.transcript_id
      and    t.gene_id=g.gene_id
      and    g.gene_id=?
      and    ox.ensembl_object_type='Translation';

      select  distinct x.dbprimary_acc
      from    xref x, interpro i, protein_feature pf, translation p, 
              transcript t, gene g
      where   g.gene_id=?
      and     g.gene_id=t.gene_id
      and     t.transcript_id=p.transcript_id
      and     p.translation_id=pf.translation_id
      and     pf.hit_name=i.id
      and     i.interpro_ac=x.dbprimary_acc;

      select x.display_label as gene_name
      from   gene g, transcript t, xref x
      where  g.gene_id=?
      and    g.canonical_transcript_id=t.transcript_id
      and    t.display_xref_id=x.xref_id;

      select meta_value as ncbi_taxonomy_id
      from   meta 
      where  meta_key='species.taxonomy_id';

    pathway_arabidopsis.search: |
      select 'GR_tax:078880' as ontology_acc;

    pathway_brachypodium.search: |
      select 'GR_tax:012596' as ontology_acc;

    pathway_rice.search: |
      select 'GR_tax:013684' as ontology_acc;

    pathway_capsicum_anuum.search: |
      select 'GR_tax:018116' as ontology_acc;

    pathway_coffea_canephora.search: |
      select 'GR_tax:052003' as ontology_acc;

    pathway_maize.search: |
      select 'GR_tax:014450' as ontology_acc;

    pathway_medicago_truncatula.search: |
      select 'GR_tax:018106' as ontology_acc;

    pathway_poplar.search: |
      select 'GR_tax:018122' as ontology_acc;

    pathway_solanum_lycopersicum.search: |
      select 'GR_tax:018113' as ontology_acc;

    pathway_solanum_tuberosum.search: |
      select 'GR_tax:018114' as ontology_acc;

    pathway_sorghum_bicolor.search: |
      select 'GR_tax:014159' as ontology_acc;

  search_dbs:
    - grm_search_ensembl_aegilops_tauschii40
    - grm_search_ensembl_arabidopsis_lyrata40
    - grm_search_ensembl_arabidopsis_thaliana40
    - grm_search_ensembl_brachypodium_distachyon40
    - grm_search_ensembl_brassica_rapa40
    - grm_search_ensembl_chlamydomonas_reinhardtii40
    - grm_search_ensembl_cyanidioschyzon_merolae40
    - grm_search_ensembl_glycine_max40
    - grm_search_ensembl_hordeum_vulgare40
    - grm_search_ensembl_leersia_perrieri40
    - grm_search_ensembl_medicago_truncatula40
    - grm_search_ensembl_musa_acuminata40
    - grm_search_ensembl_oryza_barthii40
    - grm_search_ensembl_oryza_brachyantha40
    - grm_search_ensembl_oryza_glaberrima40
    - grm_search_ensembl_oryza_glumaepatula40
    - grm_search_ensembl_oryza_granulata40
    - grm_search_ensembl_oryza_longistaminata40
    - grm_search_ensembl_oryza_meridionalis40
    - grm_search_ensembl_oryza_minutabb40
    - grm_search_ensembl_oryza_minutacc40
    - grm_search_ensembl_oryza_nivara40
    - grm_search_ensembl_oryza_officinalis40
    - grm_search_ensembl_oryza_punctata40
    - grm_search_ensembl_oryza_rufipogon3s40
    - grm_search_ensembl_oryza_rufipogon_fpc40
    - grm_search_ensembl_oryza_sativa_indica40
    - grm_search_ensembl_oryza_sativa_japonica40
    - grm_search_ensembl_physcomitrella_patens40
    - grm_search_ensembl_populus_trichocarpa40
    - grm_search_ensembl_selaginella_moellendorffii40
    - grm_search_ensembl_setaria_italica40
    - grm_search_ensembl_solanum_lycopersicum40
    - grm_search_ensembl_solanum_tuberosum40
    - grm_search_ensembl_sorghum_bicolor40
    - grm_search_ensembl_triticum_aestivum40
    - grm_search_ensembl_triticum_urartu40
    - grm_search_ensembl_vitis_vinifera40
    - grm_search_ensembl_zea_mays40
    - grm_search_maps40
    - grm_search_ontology40
    - grm_search_pathway_arabidopsis40
    - grm_search_pathway_brachypodium40
    - grm_search_pathway_coffea_canephora40
    - grm_search_pathway_maize40
    - grm_search_pathway_medicago_truncatula40
    - grm_search_pathway_plant40
    - grm_search_pathway_poplar40
    - grm_search_pathway_rice40
    - grm_search_pathway_solanum_lycopersicum40
    - grm_search_pathway_solanum_tuberosum40
    - grm_search_pathway_sorghum_bicolor40
